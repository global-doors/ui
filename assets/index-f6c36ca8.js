import{j as e,M as I,B as p,N as P,O as z,Q as W,e as F,p as N,S as b,I as j,h as V,U as G,r as f,W as H,F as T,V as B,G as U,X as A,f as E,E as Q}from"./index-abfac4d8.js";import{b as L,c as q,M as X,d as Y,e as J,O as K,f as Z,F as _,R as C,u as $}from"./rhf-text-field-92f46883.js";import{M as ee,C as w,D as se,R}from"./rhf-date-picker-0eba799c.js";import{B as D}from"./Button-19bc561b.js";import{I as y}from"./Close-6d8853a0.js";import"./KeyboardArrowRight-240f9e9d.js";const S=({name:s,chip:l,label:a,options:i,checkbox:m,placeholder:o,helperText:u,sx:x,...c})=>{const{control:t}=L(),h=r=>{const n=i.filter(d=>r.includes(d.value));return!n.length&&o?e.jsx(p,{component:"em",sx:{color:"text.disabled"},children:o}):l?e.jsx(p,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.map(d=>e.jsx(w,{label:d.label,size:"small"},d.value))}):n.map(d=>d.label).join(", ")};return e.jsx(q,{control:t,name:s,render:({field:r,fieldState:{error:n}})=>e.jsxs(X,{size:"small",sx:x,children:[a&&e.jsxs(Y,{id:s,children:[" ",a," "]}),e.jsxs(J,{...r,displayEmpty:!!o,input:e.jsx(K,{error:!!n,fullWidth:!0,label:a,size:"small"}),labelId:s,multiple:!0,renderValue:h,size:"small",...c,children:[o&&e.jsx(I,{disabled:!0,value:"",children:e.jsxs("em",{children:[" ",o," "]})}),i.map(d=>{const v=r.value.includes(d.value);return e.jsxs(I,{value:d.value,children:[m&&e.jsx(ee,{checked:v,disableRipple:!0,size:"small"}),d.label]},d.value)})]}),(!!n||u)&&e.jsx(Z,{error:!!n,children:n?n==null?void 0:n.message:u})]})})},re=s=>P(["sales-orders",s],()=>W(s),z()),te=()=>[{field:"OrderNumber",headerName:"Order No."},{field:"OrderDate",headerName:"Order Date"},{field:"OrderStatus",headerName:"Status"},{field:"CurrencyCode",headerName:"Currency",valueGetter:s=>{var l,a;return(a=(l=s.row)==null?void 0:l.Currency)==null?void 0:a.CurrencyCode}},{field:"cost",headerName:"Cost",valueGetter:()=>"TODO"}],ae=({data:s,loading:l=!1,...a})=>{const i=F(),m=o=>{const u=o.row.OrderNumber,x=N.dashboard.sales.order;i(x(u))};return e.jsx(se,{...a,autoHeight:!0,columns:te(),disableColumnMenu:!0,disableRowSelectionOnClick:!0,getRowId:o=>o.OrderNumber,loading:l,onRowClick:m,paginationMode:"server",rows:s,sx:{mx:-3,"& .MuiDataGrid-row":{cursor:"pointer"}}})},O=({label:s,children:l,sx:a,...i})=>e.jsxs(b,{component:V,direction:"row",spacing:1,sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...a},variant:"outlined",...i,children:[e.jsx(p,{component:"span",sx:{typography:"subtitle2"},children:s}),e.jsx(b,{direction:"row",flexWrap:"wrap",spacing:1,children:l})]}),le=({filters:s,onFilters:l,onResetFilters:a,results:i,...m})=>{const o=t=>{const h=s.orderStatus.filter(r=>r!==t);l("orderStatus",h)},u=t=>{const h=s.warehouse.filter(r=>r!==t);l("warehouse",h)},x=t=>{const h=s.deliveryMethod.filter(r=>r!==t);l("deliveryMethod",h)},c=!!s.orderStatus.length&&!!s.deliveryMethod.length&&!!s.warehouse.length;return e.jsxs(b,{alignItems:"flex-end",direction:"row",spacing:1,...m,children:[e.jsxs(b,{alignItems:"center",direction:"row",flexGrow:1,flexWrap:"wrap",spacing:1,children:[!!s.orderStatus.length&&e.jsx(O,{label:"Status:",children:s.orderStatus.map(t=>e.jsx(w,{label:t,onDelete:()=>o(t),size:"small"},t))}),!!s.warehouse.length&&e.jsx(O,{label:"Warehouse:",children:s.warehouse.map(t=>e.jsx(w,{label:t,onDelete:()=>u(t),size:"small"},t))}),!!s.deliveryMethod.length&&e.jsx(O,{label:"Delivery Method:",children:s.deliveryMethod.map(t=>e.jsx(w,{label:t,onDelete:()=>x(t),size:"small"},t))}),c&&e.jsx(D,{color:"error",onClick:a,startIcon:e.jsx(j,{icon:"solar:trash-bin-minimalistic-line-duotone"}),children:"Clear"})]}),e.jsxs(p,{sx:{typography:"body2"},children:[e.jsx("strong",{children:i}),e.jsx(p,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]})]})},oe=[{label:"Placed",value:"placed"},{label:"Pending",value:"pending"}],ne=[{label:"Warehouse 1",value:"warehouse1"}],de=[{label:"Royal Mail",value:"royalMail"}],ie=[{label:"Yes",value:"yes"},{label:"No",value:"no"}],ue=({methods:s,resultsCount:l,showFilters:a})=>{const i=(o,u)=>{s.reset(x=>({...x,[o]:u}))},m=()=>s.reset();return e.jsxs(_,{methods:s,children:[e.jsx(G,{in:a,children:e.jsxs(b,{spacing:2,children:[e.jsxs(p,{columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(5, 1fr)"},rowGap:3,children:[e.jsx(S,{checkbox:!0,fullWidth:!0,label:"Status",name:"orderStatus",options:oe,size:"small"}),e.jsx(C,{InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(j,{icon:"solar:magnifer-line-duotone"})})},label:"Customer Name",name:"customerName"}),e.jsx(C,{InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(j,{icon:"solar:magnifer-line-duotone"})})},label:"Order Number",name:"orderNumber"}),e.jsx(S,{checkbox:!0,fullWidth:!0,label:"Warehouse",name:"warehouse",options:ne})]}),e.jsxs(p,{columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(5, 1fr)"},rowGap:3,children:[e.jsx(C,{InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(j,{icon:"solar:magnifer-line-duotone"})})},label:"Customer Reference",name:"customerRef"}),e.jsx(S,{checkbox:!0,label:"Delivery Method",name:"deliveryMethod",options:de}),e.jsx(S,{label:"Printed",name:"printed",options:ie}),e.jsx(R,{label:"Date From",name:"dateFrom"}),e.jsx(R,{label:"Date To",name:"dateTo"})]})]})}),e.jsx(p,{sx:{py:1},children:e.jsx(le,{filters:s.watch(),onFilters:i,onResetFilters:m,results:l})})]})},be=()=>{const l=$({defaultValues:{orderStatus:[],customerName:"",orderNumber:"",customerRef:"",warehouse:[],deliveryMethod:[],printed:[],dateFrom:void 0,dateTo:void 0},mode:"onChange"}),[a,i]=f.useState(!0),m=()=>i(!a),o=F(),[u,x]=f.useState({page:0,pageSize:5}),{data:c,isLoading:t}=re({page:u.page+1,pageSize:u.pageSize}),h=c==null?void 0:c.Items,r=c==null?void 0:c.Pagination,n=l.watch(),d=f.useMemo(()=>{let g=(h??[]).slice();return n.orderStatus.length&&(g=g.filter(k=>n.orderStatus.includes(k.OrderStatus))),g},[h,n.orderStatus]),[v,M]=f.useState((r==null?void 0:r.PageSize)||0);return f.useEffect(()=>{M(g=>(r==null?void 0:r.NumberOfItems)!==void 0?r==null?void 0:r.NumberOfItems:g)},[r==null?void 0:r.NumberOfItems,M]),e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsx("title",{children:" View Sales Orders"})}),e.jsxs(T,{maxWidth:"xl",children:[e.jsx(B,{action:e.jsx(b,{direction:"row",spacing:1,children:e.jsx(D,{onClick:()=>o("/dashboard/sales/add-order"),startIcon:e.jsx(j,{icon:"solar:add-square-line-duotone"}),variant:"contained",children:"Add Sales Order"})}),heading:"View Sales Orders",links:[{name:"Sales",href:N.dashboard.root},{name:"View Sales Orders"}],sx:{mb:{xs:3,md:5}}}),e.jsxs(U,{children:[e.jsx(A,{action:e.jsx(E,{onClick:m,children:e.jsx(j,{icon:a?"solar:filter-bold-duotone":"solar:filter-line-duotone"})})}),e.jsxs(Q,{sx:{pt:0},children:[e.jsx(ue,{methods:l,resultsCount:d.length,showFilters:a}),e.jsx(ae,{data:d,loading:t,onPaginationModelChange:x,paginationMode:"server",paginationModel:u,rowCount:v})]})]})]})]})};export{be as default};
